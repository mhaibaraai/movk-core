import{useStorage as O}from"@vueuse/core";import{z as y}from"zod/v4";const x=y.enum(["localStorage","sessionStorage"]);function A(t){return y.object({key:y.string().min(1,{message:"Key cannot be empty"}),schema:y.custom(e=>e instanceof y.ZodType,{message:"Schema must be a valid Zod schema"}),defaultValue:y.custom(e=>t.safeParse(e).success,{message:"Default value must match the provided schema"}),prefix:y.string().default("movk"),storage:x.default("localStorage")})}function k(t){const e=A(t.schema).parse(t),{key:n,defaultValue:r,schema:o,storage:i,prefix:a}=e,s=`${a}:${n}`,c=(()=>{if(!(typeof window>"u"))return i==="localStorage"?localStorage:sessionStorage})();function l(p){if(p===null)return r;try{const g=JSON.parse(p),w=o.safeParse(g);return w.success?w.data:(console.warn(`[AppStorage] Validation failed for key "${s}". Using default value.`,w.error.issues),r)}catch(g){return console.warn(`[AppStorage] Failed to parse value for key "${s}". Using default value.`,g),r}}const u=O(s,r,c,{mergeDefaults:!0,serializer:{read:l,write:p=>JSON.stringify(p)}});function d(){if(!c)return r;const p=c.getItem(s);return l(p)}function h(p){const g=o.safeParse(p);if(!g.success){console.warn(`[AppStorage] Invalid value for key "${s}". Aborting setItem.`,g.error.issues);return}u.value=g.data}function f(){c&&(u.value=null)}return{state:u,getItem:d,setItem:h,removeItem:f}}async function $(t){if(typeof t!="string")throw new TypeError("Text must be a string");if(typeof window>"u")return console.warn("useCopyCode: Not available in server environment"),!1;if(navigator.clipboard&&window.isSecureContext)try{return await navigator.clipboard.writeText(t),!0}catch(e){console.warn("Clipboard API failed, falling back to legacy method:",e)}try{return I(t)}catch(e){return console.error("Failed to copy text:",e),!1}}function I(t){if(typeof document>"u")return console.warn("copyTextLegacy: Document not available"),!1;const e=document.createElement("textarea"),n=document.activeElement,r=document.getSelection(),o=r&&r.rangeCount>0?r.getRangeAt(0):null;try{return e.value=t,e.setAttribute("readonly",""),e.setAttribute("contenteditable","true"),Object.assign(e.style,{contain:"strict",position:"absolute",left:"-9999px",top:"-9999px",fontSize:"12pt",border:"0",padding:"0",margin:"0",outline:"none",boxShadow:"none",background:"transparent"}),document.body.appendChild(e),e.focus(),e.select(),e.setSelectionRange&&e.setSelectionRange(0,t.length),document.execCommand("copy")}catch(i){return console.error("Legacy copy method failed:",i),!1}finally{e.parentNode&&document.body.removeChild(e),o&&r&&(r.removeAllRanges(),r.addRange(o)),n instanceof HTMLElement&&n.focus()}}const m=y.object({id:y.string().default("id"),pid:y.string().default("pid"),children:y.string().default("children")});y.object({total:y.number().int().nonnegative(),leaves:y.number().int().nonnegative(),depth:y.number().int().nonnegative(),branches:y.number().int().nonnegative()});class b{static*dfsGenerator(e,n={},r=[]){const{children:o}=m.parse(n);let i=0;for(const a of e){const s=[...r,a];yield{node:a,path:s,depth:r.length,index:i++};const c=a[o];c&&c.length>0&&(yield*b.dfsGenerator(c,n,s))}}static*bfsGenerator(e,n={}){const{children:r}=m.parse(n),o=e.map((a,s)=>({node:a,path:[a],depth:0,index:s}));let i=e.length;for(;o.length>0;){const a=o.shift();yield a;const s=a.node[r];s&&s.length>0&&s.forEach(c=>{const l=[...a.path,c];o.push({node:c,path:l,depth:a.depth+1,index:i++})})}}static selectStrategy(e){switch(e){case"find":case"findAll":case"filter":case"transform":case"forEach":case"stats":case"validate":return"dfs";default:return"dfs"}}static fromList(e,n={}){const r=m.parse(n),{id:o,pid:i,children:a}=r;if(!Array.isArray(e)||e.length===0)return[];const s=new Map,c=[];return e.forEach(l=>{const u={...l,[a]:[]};s.set(l[o],u)}),e.forEach(l=>{const u=s.get(l[o]),d=l[i];d&&s.has(d)?s.get(d)[a].push(u):c.push(u)}),c}static toList(e,n={}){const r=m.parse(n),{children:o}=r,i=[],a=Array.isArray(e)?e:[e],s=c=>{const{[o]:l,...u}=c;i.push(u),l&&l.length>0&&l.forEach(s)};return a.forEach(s),i}static estimateSize(e,n={}){const r=m.parse(n),{children:o}=r,i=Array.isArray(e)?e:[e];let a=0;const s=c=>{a++;const l=c[o];l&&l.length>0&&l.forEach(s)};return i.forEach(s),a}static find(e,n,r={}){const o=Array.isArray(e)?e:[e],i=b.selectStrategy("find")==="dfs"?b.dfsGenerator(o,r):b.bfsGenerator(o,r);for(const a of i)if(n(a.node,a.depth,a.path))return a}static findAll(e,n,r={}){const o=Array.isArray(e)?e:[e],i=b.selectStrategy("findAll"),a=[],s=i==="dfs"?b.dfsGenerator(o,r):b.bfsGenerator(o,r);for(const c of s)n(c.node,c.depth,c.path)&&a.push(c);return a}static findById(e,n,r={}){const o=m.parse(r),{id:i}=o;return this.find(e,a=>a[i]===n,r)}static getStats(e,n={}){const r=m.parse(n),{children:o}=r,i=Array.isArray(e)?e:[e];let a=0,s=0,c=0,l=0;const u=(d,h)=>{a++,c=Math.max(c,h);const f=d[o];f&&f.length>0?(l++,f.forEach(p=>u(p,h+1))):s++};return i.forEach(d=>u(d,1)),{total:a,leaves:s,depth:c,branches:l}}static filter(e,n,r={}){const o=m.parse(r),{children:i}=o,a=Array.isArray(e)?e:[e],s=[],c=(l,u,d)=>{const h=l[i],f=[];if(h&&h.length>0){const p=[...d,l];h.forEach(g=>{const w=c(g,u+1,p);w&&f.push(w)})}return n(l,u,d)||f.length>0?{...l,[i]:f}:null};return a.forEach(l=>{const u=c(l,0,[]);u&&s.push(u)}),s}static transform(e,n,r={}){const o=m.parse(r),{children:i}=o,a=Array.isArray(e)?e:[e],s=[],c=(l,u,d)=>{const h=l[i],f=[];if(h&&h.length>0){const p=[...d,l];h.forEach(g=>{f.push(c(g,u+1,p))})}return{...n(l,u,d),[i]:f}};return a.forEach(l=>{s.push(c(l,0,[]))}),s}static forEach(e,n,r={}){const o=m.parse(r),{children:i}=o,a=Array.isArray(e)?e:[e],s=(c,l,u)=>{if(n(c,l,u)!==!1){const d=c[i];if(d&&d.length>0){const h=[...u,c];d.forEach(f=>{s(f,l+1,h)})}}};a.forEach(c=>s(c,0,[]))}static insertBefore(e,n,r,o={}){const i=m.parse(o),{id:a,children:s}=i,c={...r,[s]:[]},l=(u,d)=>{for(let h=0;h<u.length;h++){const f=u[h];if(f[a]===n)return u.splice(h,0,c),!0;const p=f[s];if(p&&p.length>0){const g=[...d,f];if(l(p,g))return!0}}return!1};return l(e,[])}static insertAfter(e,n,r,o={}){const i=m.parse(o),{id:a,children:s}=i,c={...r,[s]:[]},l=(u,d)=>{for(let h=0;h<u.length;h++){const f=u[h];if(f[a]===n)return u.splice(h+1,0,c),!0;const p=f[s];if(p&&p.length>0){const g=[...d,f];if(l(p,g))return!0}}return!1};return l(e,[])}static remove(e,n,r={}){const o=m.parse(r),{id:i,children:a}=o,s=c=>{for(let l=0;l<c.length;l++){const u=c[l];if(u[i]===n)return c.splice(l,1)[0];const d=u[a];if(d&&d.length>0){const h=s(d);if(h)return h}}};return s(e)}static validate(e,n={}){const r=m.parse(n),{id:o,children:i}=r,a=Array.isArray(e)?e:[e],s=[],c=new Set,l=(u,d,h)=>{const f=u[o];if(!f||typeof f!="string"){s.push(`Node at depth ${d} has invalid or missing ID`);return}if(c.has(f)){s.push(`Duplicate ID found: ${f}`);return}if(c.add(f),h.some(g=>g[o]===f)){s.push(`Circular reference detected for ID: ${f}`);return}const p=u[i];if(p!==void 0&&!Array.isArray(p)){s.push(`Node ${f} has invalid children property (not an array)`);return}if(p&&p.length>0){const g=[...h,u];p.forEach(w=>{l(w,d+1,g)})}};return a.forEach(u=>l(u,0,[])),{isValid:s.length===0,errors:s}}}function G(t){return[...new Set(t)]}function N(t,e){const n=[];for(let r=0;r<t.length;r+=e)n.push(t.slice(r,r+e));return n}function T(t,e=1){return e===1?t.flat():t.flat(e)}function D(t,e){let n;return(...r)=>{clearTimeout(n),n=setTimeout(()=>t(...r),e)}}function F(t){return new Promise(e=>setTimeout(e,t))}function M(t){let e,n;return{promise:new Promise((r,o)=>{n=o,e=setTimeout(r,t)}),cancel:()=>{clearTimeout(e),n(new Error("Sleep was cancelled"))}}}function P(t,e){let n=!1;return function(...r){n||(t.apply(this,r),n=!0,setTimeout(()=>{n=!1},e))}}async function U(t){if(!t||typeof t!="string")throw new Error("Invalid SVG string provided");if(typeof window>"u"||typeof document>"u")throw new TypeError("convertSvgToPng is only available in browser environment");return new Promise((e,n)=>{const r=new Image,o=document.createElement("canvas"),i=o.getContext("2d");if(!i){n(new Error("Canvas context not available"));return}r.onload=()=>{try{o.width=r.width,o.height=r.height,i.drawImage(r,0,0),o.toBlob(a=>{a?e(a):n(new Error("Failed to convert canvas to Blob"))},"image/png")}catch(a){n(new Error(`Error during canvas conversion: ${a}`))}},r.onerror=()=>{n(new Error("Failed to load SVG image"))};try{r.src=`data:image/svg+xml;base64,${btoa(t)}`}catch(a){n(new Error(`Failed to encode SVG: ${a}`))}})}function L(t,e="file"){if(!t)return e;const n=t.get("content-disposition");if(n){const r=n.match(/filename\*?=['"]?([^'";]+)['"]?/i);if(r){let o=r[1];if(n.includes("filename*=")){const i=o.split("''");i.length===2&&(o=decodeURIComponent(i[1]))}return o}}return e}function V(t,e){if(typeof window>"u"||typeof document>"u"){console.warn("triggerDownload: Not available in server environment");return}const n=URL.createObjectURL(t),r=document.createElement("a");r.href=n,r.download=e,r.style.display="none",document.body.appendChild(r),r.click(),document.body.removeChild(r),URL.revokeObjectURL(n)}function z(t){if(!Number.isFinite(t)||t<0||t===0)return"0 Bytes";const e=1024,n=["Bytes","KB","MB","GB","TB","PB"],r=Math.floor(Math.log(t)/Math.log(e));return r>=n.length?`${Number.parseFloat((t/e**(n.length-1)).toFixed(2))} ${n[n.length-1]}`:`${Number.parseFloat((t/e**r).toFixed(2))} ${n[r]}`}async function B(t,e){if(!t||typeof t!="string")throw new Error("Invalid SVG path provided");try{const n=await fetch(t);if(!n.ok)throw new Error(`Failed to fetch SVG file: ${n.status} ${n.statusText}`);const r=await n.text();if(!e)return r;if(typeof window>"u"||typeof DOMParser>"u")return console.warn("replaceCurrentColor: DOM manipulation not available in server environment, returning original SVG"),r;const o=new DOMParser().parseFromString(r,"image/svg+xml");if(o.querySelector("parsererror"))throw new Error("Invalid SVG content");const i=o.querySelector("svg");if(!i)throw new Error("No SVG element found in the document");i.hasAttribute("fill")||i.setAttribute("fill","currentColor");const a=s=>{s.getAttribute("fill")==="currentColor"&&s.setAttribute("fill",e),s.getAttribute("stroke")==="currentColor"&&s.setAttribute("stroke",e),Array.from(s.children).forEach(c=>{a(c)})};return a(i),new XMLSerializer().serializeToString(o)}catch(n){throw n instanceof Error?n:new Error(`Unexpected error occurred: ${n}`)}}function S(t,e=!1){if(!t||typeof t!="object"||Array.isArray(t))return t;const n=o=>o.replace(/([a-z\d])([A-Z])/g,"$1-$2").toLowerCase(),r={};for(const o in t)if(Object.prototype.hasOwnProperty.call(t,o)){const i=n(o),a=t[o];e&&a&&typeof a=="object"&&!Array.isArray(a)?r[i]=S(a,!0):r[i]=a}return r}function v(t){if(t===null||typeof t!="object")return t;if(t instanceof Date)return new Date(t.getTime());if(Array.isArray(t))return t.map(e=>v(e));if(typeof t=="object"){const e={};for(const n in t)e[n]=v(t[n]);return e}return t}function R(t,e){if(!t||typeof t!="object")return{};const n=new Set(e),r={};for(const o in t)Object.prototype.hasOwnProperty.call(t,o)&&!n.has(o)&&(r[o]=t[o]);return r}function K(t){return!t||typeof t!="object"||Array.isArray(t)?t:Object.fromEntries(Object.entries(t).filter(([,e])=>e!==void 0))}function Z(t,e){if(!t||typeof t!="object")return{};const n={};for(const r of e)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r]);return n}function q(t,e){if(!t||typeof t!="object")return{picked:{},omitted:{}};if(e.length===0)return{picked:{},omitted:{...t}};const n=new Set(e),r={},o={};for(const i in t)if(Object.hasOwn(t,i)){const a=i;n.has(a)?r[i]=t[a]:o[i]=t[a]}return{picked:r,omitted:o}}function H(t,e){if(!t||typeof t!="object")return{...Object.fromEntries(Object.keys(e).map(i=>[i,{}])),others:{}};const n=Object.keys(e),r=new Map;for(const i of n){const a=new Set(e[i]);r.set(i,a)}const o=Object.create(null);for(const i of n)o[i]={};o.others={};for(const i in t)if(Object.hasOwn(t,i)){const a=i;let s=!1;for(const c of n)if(r.get(c).has(a)){o[c][i]=t[a],s=!0;break}s||(o.others[i]=t[a])}return o}function J(t){return t.charAt(0).toUpperCase()+t.slice(1)}function W(t){return t.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}function X(t){return t.replace(/-([a-z])/g,(e,n)=>n.toUpperCase())}function Q(t){let e=0;for(let n=0;n<t.length;n++){const r=t.charCodeAt(n);e=(e<<5)-e+r,e=e&e}return Math.abs(e).toString(36)}function Y(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,t=>{const e=Math.random()*16|0;return(t==="x"?e:e&3|8).toString(16)})}function E(t){return t!==null&&typeof t=="object"&&!Array.isArray(t)}function C(t){return Array.isArray(t)}function j(t){return typeof t=="string"}function _(t){return typeof t=="number"&&!Number.isNaN(t)}function ee(t){return typeof t=="function"}function te(t){return t==null?!0:C(t)||j(t)?t.length===0:E(t)?Object.keys(t).length===0:!1}export{x as StorageTypeSchema,b as Tree,W as camelToKebab,J as capitalize,N as chunk,U as convertSvgToPng,S as convertToKebabCase,A as createStorageConfigSchema,D as debounce,v as deepClone,L as extractFilename,T as flatten,z as formatFileSize,Y as getRandomUUID,C as isArray,te as isEmpty,ee as isFunction,_ as isNumber,E as isObject,j as isString,X as kebabToCamel,R as omit,K as omitUndefined,Z as pick,B as replaceCurrentColor,q as separate,H as separateMany,Q as simpleHash,F as sleep,M as sleepWithCancel,P as throttle,V as triggerDownload,G as unique,k as useAppStorage,$ as useCopyCode};
